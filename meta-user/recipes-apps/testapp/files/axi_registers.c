#include "axi_registers.h"

#define NUM_WRITE_16 (sizeof(operation_write_16) / sizeof(operation_write_16[0]))
#define NUM_READ_16  (sizeof(operation_read_16) / sizeof(operation_read_16[0]))
#define NUM_WRITE_32 (sizeof(operation_write_32) / sizeof(operation_write_32[0]))
#define NUM_READ_32  (sizeof(operation_read_32) / sizeof(operation_read_32[0]))

int axi_main() {
    int option;
    int l_hFile = open(Driver_path, O_WRONLY); // Example file handle for the device
    struct mem s_obj_mem;
    int l_result;

    // Example data for 16-bit and 32-bit operations
    unsigned int operation_write_16[] = {
	    0x800000C8, 0x800000CA, 0x800000CC, 0x800000CE, 0x800000D0, 0x800000D2, 0x800000D4, 0x800000D6,
		0x800000D8, 0x800000DA, 0x800000DC, 0x800000DE, 0x800000E0, 0x800000E2, 0x800000E4, 0x800000E6,
		0x800000E8, 0x800000EA, 0x800000EC, 0x800000EE, 0x800000F0, 0x800000F2, 0x800000F4, 0x800000F6,
		0x800000F8, 0x800000FA, 0x800000FC, 0x800000FE, 0x80000100, 0x80000102, 0x80000104, 0x80000106,
		0x80000108, 0x8000010A, 0x8000010C, 0x8000010E, 0x80000110, 0x80000112, 0x80000114, 0x80000116,
		0x80000118, 0x8000011A, 0x8000011C, 0x8000011E, 0x80000120, 0x80000122, 0x80000124, 0x80000126,
		0x80000128, 0x8000012A, 0x80000190, 0x80000194, 0x80000198, 0x8000019C, 0x800001A0, 0x800001A4,
		0x800001A8, 0x800001AC, 0x800001B0, 0x800001B4, 0x800001B8, 0x800001BC, 0x800001C0, 0x800001C4,
		0x800001C8, 0x800001CC, 0x800001D0, 0x800001D4, 0x800001D8, 0x800001DC, 0x800001E0, 0x800001E4,
		0x800001E8, 0x800001EC, 0x800001F0, 0x800001F4, 0x800001F8, 0x800001FC, 0x80000200, 0x80000204,
		0x80000208, 0x8000020C, 0x80000210, 0x80000214, 0x80000218, 0x8000021C, 0x80000220, 0x80000224,
		0x80000228, 0x8000022C, 0x80000230, 0x80000234, 0x80000238, 0x8000023C, 0x80000240, 0x80000244,
		0x80000248, 0x8000024C, 0x80000250, 0x80000254
	};

    unsigned int data_write_16[] = {
		0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006, 0x00000007, 0x00000008,
		0x00000009, 0x00000010, 0x00000011, 0x00000012, 0x00000013, 0x00000014, 0x00000015, 0x00000016,
		0x00000017, 0x00000018, 0x00000019, 0x00000020, 0x00000021, 0x00000022, 0x00000023, 0x00000024,
		0x00000025, 0x00000026, 0x00000027, 0x00000028, 0x00000029, 0x00000030, 0x00000031, 0x00000032,
		0x00000033, 0x00000034, 0x00000035, 0x00000036, 0x00000037, 0x00000038, 0x00000039, 0x00000040,
		0x00000041, 0x00000042, 0x00000043, 0x00000044, 0x00000045, 0x00000046, 0x00000047, 0x00000048,
		0x00000049, 0x00000050, 0x00000051, 0x00000052, 0x00000053, 0x00000054, 0x00000055, 0x00000056,
		0x00000057, 0x00000058, 0x00000059, 0x00000060, 0x00000061, 0x00000062, 0x00000063, 0x00000064,
		0x00000065, 0x00000066, 0x00000067, 0x00000068, 0x00000069, 0x00000070, 0x00000071, 0x00000072,
		0x00000073, 0x00000074, 0x00000075, 0x00000076, 0x00000077, 0x00000078, 0x00000079, 0x00000080,
		0x00000081, 0x00000082, 0x00000083, 0x00000084, 0x00000085, 0x00000086, 0x00000087, 0x00000088,
		0x00000089, 0x00000090, 0x00000091, 0x00000092, 0x00000093, 0x00000094, 0x00000095, 0x00000096,
		0x00000097, 0x00000098, 0x00000099, 0x00000100
	};

    unsigned int operation_read_16[] = {
		0x800000C8, 0x800000CA, 0x800000CC, 0x800000CE, 0x800000D0, 0x800000D2, 0x800000D4, 0x800000D6,
		0x800000D8, 0x800000DA, 0x800000DC, 0x800000DE, 0x800000E0, 0x800000E2, 0x800000E4, 0x800000E6,
		0x800000E8, 0x800000EA, 0x800000EC, 0x800000EE, 0x800000F0, 0x800000F2, 0x800000F4, 0x800000F6,
		0x800000F8, 0x800000FA, 0x800000FC, 0x800000FE, 0x80000100, 0x80000102, 0x80000104, 0x80000106,
		0x80000108, 0x8000010A, 0x8000010C, 0x8000010E, 0x80000110, 0x80000112, 0x80000114, 0x80000116,
		0x80000118, 0x8000011A, 0x8000011C, 0x8000011E, 0x80000120, 0x80000122, 0x80000124, 0x80000126,
		0x80000128, 0x8000012A, 0x80000190, 0x80000194, 0x80000198, 0x8000019C, 0x800001A0, 0x800001A4,
		0x800001A8, 0x800001AC, 0x800001B0, 0x800001B4, 0x800001B8, 0x800001BC, 0x800001C0, 0x800001C4,
		0x800001C8, 0x800001CC, 0x800001D0, 0x800001D4, 0x800001D8, 0x800001DC, 0x800001E0, 0x800001E4,
		0x800001E8, 0x800001EC, 0x800001F0, 0x800001F4, 0x800001F8, 0x800001FC, 0x80000200, 0x80000204,
		0x80000208, 0x8000020C, 0x80000210, 0x80000214, 0x80000218, 0x8000021C, 0x80000220, 0x80000224,
		0x80000228, 0x8000022C, 0x80000230, 0x80000234, 0x80000238, 0x8000023C, 0x80000240, 0x80000244,
		0x80000248, 0x8000024C, 0x80000250, 0x80000254
	};

    unsigned int operation_write_32[] = {
		0x80000000, 0x80000004, 0x80000008, 0x8000000C, 0x80000010, 0x80000014, 0x80000018, 0x8000001C,
		0x80000020, 0x80000024, 0x80000028, 0x8000002C, 0x80000030, 0x80000034, 0x80000038, 0x8000003C,
		0x80000040, 0x80000044, 0x80000048, 0x8000004C, 0x80000050, 0x80000054, 0x80000058, 0x8000005C,
		0x80000060, 0x80000064, 0x80000068, 0x8000006C, 0x80000070, 0x80000074, 0x80000078, 0x8000007C,
		0x80000080, 0x80000084, 0x80000088, 0x8000008C, 0x80000090, 0x80000094, 0x80000098, 0x8000009C,
		0x800000A0, 0x800000A4, 0x800000A8, 0x800000AC, 0x800000B0, 0x800000B4, 0x800000B8, 0x800000BC,
		0x800000C0, 0x800000C4, 0x80000190, 0x80000194, 0x80000198, 0x8000019C, 0x800001A0, 0x800001A4,
		0x800001A8, 0x800001AC, 0x800001B0, 0x800001B4, 0x800001B8, 0x800001BC, 0x800001C0, 0x800001C4,
		0x800001C8,	0x800001CC, 0x800001D0,	0x800001D4, 0x800001D8,	0x800001DC, 0x800001E0, 0x800001E4,
		0x800001E8, 0x800001EC, 0x800001F0, 0x800001F4, 0x800001F8, 0x800001FC,	0x80000200, 0x80000204,
		0x80000208, 0x8000020C, 0x80000210, 0x80000214, 0x80000218, 0x8000021C, 0x80000220, 0x80000224,
		0x80000228, 0x8000022C, 0x80000230, 0x80000234, 0x80000238, 0x8000023C, 0x80000240, 0x80000244,
		0x80000248, 0x8000024C, 0x80000250, 0x80000254
	};

    unsigned int data_write_32[] = {
		0x00000001, 0x00000002, 0x00000003, 0x00000004, 0x00000005, 0x00000006, 0x00000007, 0x00000008,
		0x00000009, 0x00000010, 0x00000011, 0x00000012, 0x00000013, 0x00000014, 0x00000015, 0x00000016,
		0x00000017, 0x00000018, 0x00000019, 0x00000020, 0x00000021, 0x00000022, 0x00000023, 0x00000024,
		0x00000025, 0x00000026, 0x00000027, 0x00000028, 0x00000029, 0x00000030, 0x00000031, 0x00000032,
		0x00000033, 0x00000034, 0x00000035, 0x00000036, 0x00000037, 0x00000038, 0x00000039, 0x00000040,
		0x00000041, 0x00000042, 0x00000043, 0x00000044, 0x00000045, 0x00000046, 0x00000047, 0x00000048,
		0x00000049, 0x00000050, 0x00000051, 0x00000052, 0x00000053, 0x00000054, 0x00000055, 0x00000056,
		0x00000057, 0x00000058, 0x00000059, 0x00000060, 0x00000061, 0x00000062, 0x00000063, 0x00000064,
		0x00000065, 0x00000066, 0x00000067, 0x00000068, 0x00000069, 0x00000070, 0x00000071, 0x00000072,
		0x00000073, 0x00000074, 0x00000075, 0x00000076, 0x00000077, 0x00000078, 0x00000079, 0x00000080,
		0x00000081, 0x00000082, 0x00000083, 0x00000084, 0x00000085, 0x00000086, 0x00000087, 0x00000088,
		0x00000089, 0x00000090, 0x00000091, 0x00000092, 0x00000093, 0x00000094, 0x00000095, 0x00000096,
		0x00000097, 0x00000098, 0x00000099, 0x00000100
	};

    unsigned int operation_read_32[] = {
		0x80000000, 0x80000004, 0x80000008, 0x8000000C, 0x80000010, 0x80000014, 0x80000018, 0x8000001C,
		0x80000020, 0x80000024, 0x80000028, 0x8000002C, 0x80000030, 0x80000034, 0x80000038, 0x8000003C,
		0x80000040, 0x80000044, 0x80000048, 0x8000004C, 0x80000050, 0x80000054, 0x80000058, 0x8000005C,
		0x80000060, 0x80000064, 0x80000068, 0x8000006C, 0x80000070, 0x80000074, 0x80000078, 0x8000007C,
		0x80000080, 0x80000084, 0x80000088, 0x8000008C, 0x80000090, 0x80000094, 0x80000098, 0x8000009C,
		0x800000A0, 0x800000A4, 0x800000A8, 0x800000AC, 0x800000B0, 0x800000B4, 0x800000B8, 0x800000BC,
		0x800000C0, 0x800000C4, 0x80000190, 0x80000194, 0x80000198, 0x8000019C, 0x800001A0, 0x800001A4,
		0x800001A8, 0x800001AC, 0x800001B0, 0x800001B4, 0x800001B8, 0x800001BC, 0x800001C0, 0x800001C4,
		0x800001C8,	0x800001CC, 0x800001D0,	0x800001D4, 0x800001D8,	0x800001DC, 0x800001E0, 0x800001E4,
		0x800001E8, 0x800001EC, 0x800001F0, 0x800001F4, 0x800001F8, 0x800001FC,	0x80000200, 0x80000204,
		0x80000208, 0x8000020C, 0x80000210, 0x80000214, 0x80000218, 0x8000021C, 0x80000220, 0x80000224,
		0x80000228, 0x8000022C, 0x80000230, 0x80000234, 0x80000238, 0x8000023C, 0x80000240, 0x80000244,
		0x80000248, 0x8000024C, 0x80000250, 0x80000254
	};

    // Prompt user input
    printf("Enter the option:\n");
    printf("1. 16-bit read and write operations\n");
    printf("2. 32-bit read and write operations\n");
    scanf("%d", &option);

    if (option == 1) {
        /* Perform 16-bit write operations */
        for (size_t i = 0; i < NUM_WRITE_16; i++) {
            s_obj_mem.operation = OP_16BIT_WRITE; // 16-bit write operation
            s_obj_mem.address = operation_write_16[i];
            s_obj_mem.value = data_write_16[i];
            l_result = ioctl(l_hFile, 0, &s_obj_mem);
            if (l_result == -1) {
                printf("16-bit write failed for address %X\n", s_obj_mem.address);
                close(l_hFile);
                return DIR_FAILURE;
            }
            printf("16-bit Write: Address: 0x%08X written value: 0x%08X\n", s_obj_mem.address, s_obj_mem.value);
        }

        /* Perform 16-bit read operations */
        for (size_t i = 0; i < NUM_READ_16; i++) {
            s_obj_mem.operation = OP_16BIT_READ; // 16-bit read operation
            s_obj_mem.address = operation_read_16[i];
            l_result = ioctl(l_hFile, 0, &s_obj_mem);
            if (l_result == -1) {
                printf("16-bit read failed for address %X\n", s_obj_mem.address);
                close(l_hFile);
                return DIR_FAILURE;
            }
            printf("16-bit Read: Address: 0x%08X Value: 0x%08X\n", s_obj_mem.address, s_obj_mem.value);
        }
    } else if (option == 2) {
        /* Perform 32-bit write operations */
        for (size_t i = 0; i < NUM_WRITE_32; i++) {
            s_obj_mem.operation = OP_32BIT_WRITE; // 32-bit write operation
            s_obj_mem.address = operation_write_32[i];
            s_obj_mem.value = data_write_32[i];
            l_result = ioctl(l_hFile, 0, &s_obj_mem);
            if (l_result == -1) {
                printf("32-bit write failed for address %X\n", s_obj_mem.address);
                close(l_hFile);
                return DIR_FAILURE;
            }
            printf("32-bit Write: Address: 0x%08X written value: 0x%08X\n", s_obj_mem.address, s_obj_mem.value);
        }

        /* Perform 32-bit read operations */
        for (size_t i = 0; i < NUM_READ_32; i++) {
            s_obj_mem.operation = OP_32BIT_READ; // 32-bit read operation
            s_obj_mem.address = operation_read_32[i];
            l_result = ioctl(l_hFile, 0, &s_obj_mem);
            if (l_result == -1) {
                printf("32-bit read failed for address %X\n", s_obj_mem.address);
                close(l_hFile);
                return DIR_FAILURE;
            }
            printf("32-bit Read: Address: 0x%08X Value: 0x%08X\n", s_obj_mem.address, s_obj_mem.value);
        }
    } else {
        printf("Invalid option selected.\n");
    }

    close(l_hFile);
    return 0;
}
